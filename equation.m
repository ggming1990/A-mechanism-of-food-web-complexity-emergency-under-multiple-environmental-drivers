function output=equation(~,rho,S,Tij,ci,cj,ei,m,ej,M1,s1,M2,D,u1,u2,R) % rho-initial species abundance, S-ecosystem size, R-resource productivity, D-disturbance extent, Tij-matrix involving species colonization and competition, ci-basal species colonization rates, cj-consumers' colonization rates, ei-basal species mortality rate, ej-consumers' mortality rate, m-the number of basal species, u1-predation rate of consumer preying on basal species, u2-predation rate between consumers, M1-interaction matrix between basal species and consumers, M2-interaction matrix between consumers
dyn1=Tij.*(rho(1:m,1)*rho(1:m,1)').*R;
output(1:m,1) = ci.*rho(1:m,1).*R.*(S-sum(rho(1:m,1)))-ei.*rho(1:m,1)+sum(dyn1,2)+rho(1:m,1).*log(1-D)-(sum(u1.*rho(m+1:s1+m,1).*M1'))'.*rho(1:m,1);
output(m+1:s1+m,1)=(cj.*rho(m+1:s1+m,1).*(sum(repmat(rho(1:m,1),1,s1).*M1))'+rho(m+1:s1+m,1).*log(1-D)+cj.*rho(m+1:s1+m,1).*(sum(repmat(rho(m+1:s1+m,1),1,s1).*M2))').*(S-rho(m+1:s1+m,1))-ej.*rho(m+1:s1+m,1)-sum(u2.*rho(m+1:s1+m,1).*M2')'.*rho(m+1:s1+m,1);